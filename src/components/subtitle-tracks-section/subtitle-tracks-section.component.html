@if (subtitleTracks().length > 0) {
<div class="subtitle-tracks-section">
  <div class="section-header" (click)="toggleSubtitleSection()">
    <div class="header-content">
      <mat-icon class="section-icon">subtitles</mat-icon>
      <h5>Subtitles ({{ subtitleTracks().length }})</h5>
      <div class="track-count">
        {{ getSelectedSubtitleTracksCount() }} selected
      </div>
    </div>
    <mat-icon class="expand-icon" [class.expanded]="subtitleSectionExpanded()">
      expand_more
    </mat-icon>
  </div>

  <div class="tracks-container" [class.expanded]="subtitleSectionExpanded()">
    <div class="tracks-header">
      <mat-checkbox
        [checked]="areAllSubtitleTracksSelected()"
        [indeterminate]="areSomeSubtitleTracksSelected()"
        (change)="toggleAllSubtitleTracks($event.checked)"
      >
        Select All
      </mat-checkbox>
    </div>

    @for (track of subtitleTracks(); track $index) {
    <div class="track-item">
      <div class="track-header">
        <mat-checkbox
          [checked]="isSubtitleTrackSelected(track.index)"
          (change)="toggleSubtitleTrack(track.index, $event.checked)"
        >
        </mat-checkbox>
        <mat-icon class="track-icon">subtitles</mat-icon>
        <span class="track-index">Track {{ track.index }}</span>
        @if (track.language) {
        <mat-chip class="language-chip">{{
          track.language.toUpperCase()
        }}</mat-chip>
        } @if (track.is_default) {
        <mat-chip class="default-chip" color="primary">Default</mat-chip>
        } @if (track.is_forced) {
        <mat-chip class="forced-chip" color="accent">Forced</mat-chip>
        }
      </div>
      <div class="track-details">
        <div class="track-info"><strong>Codec:</strong> {{ track.codec }}</div>
        @if (track.title) {
        <div class="track-info"><strong>Title:</strong> {{ track.title }}</div>
        }
      </div>
    </div>
    }
  </div>
</div>
}
